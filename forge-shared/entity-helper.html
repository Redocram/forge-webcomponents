<script>
(function() {

  "use strict";

  window.ForgeWebComponents = window.ForgeWebComponents || {};
  window.ForgeWebComponents.Helpers = window.ForgeWebComponents.Helpers || {};
  window.ForgeWebComponents.Helpers.EntityHelper = {
    pluralize: pluralize,
    createLink: createLink,
    createSearchLink: createSearchLink
  };

  function pluralize(entityType) {

    if (entityType.endsWith("y")) {
      return entityType.substring(0, entityType.length - 1) + "ies";
    }
    if (entityType.endsWith("s") ||
        entityType.endsWith("x") ||
        entityType.endsWith("sh") ||
        entityType.endsWith("ch")) {
      return entityType + "es";
    }
    return entityType + "s";

  }

  function createLink(entityType, entityId, translationId) {

    var rootUrl = "#/wcm/";
    var result;

    switch (entityType) {
      case "story":
        result = rootUrl + pluralize(entityType) + "/" + translationId
        break;
      case "photo":
      case "document":
      case "tag":
      case "selection":
      case "album":
        result = rootUrl + pluralize(entityType) + "/" + entityId
        break;
      default:
        result = rootUrl + "custom/" + entityType + "/" + entityId;
        break;
    }

    return result;

  }

  function createSearchLink(entityType, query){
    var rootUrl = "#/wcm/";
    var result;

    switch (entityType) {
      case "story":
      case "photo":
      case "document":
      case "tag":
      case "selection":
      case "album":
        result = rootUrl + pluralize(entityType);
        break;
      default:
        result =  rootUrl + "custom/" + entityType;
        break;
    }
    if(result && query){
      var queryString = "?search=";

      for(var k in query){
        queryString += (k.toLowerCase() + ":" + query[k] + " ");
      }

      queryString = queryString.trim();

      result += encodeURI(queryString);
    }

    return result;
  }

})();
</script>
