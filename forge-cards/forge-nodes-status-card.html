<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/polymer/polymer.html">

<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/paper-styles/color.html">

<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/iron-icons/social-icons.html">
<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/iron-icons/device-icons.html">
<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/iron-icons/iron-icons.html">

<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/paper-material/paper-material.html">
<link rel="import" href="../forge-api-behavior/forge-heartbeats-polling-behavior.html">
<link rel="import" href="../libraries/libraries.html">
<link rel="import" href="../shared/api.html">

<dom-module id="forge-nodes-status-card">

  <style>
    :host {
      display: block;
    }

    .status-0 {
      color: var(--status-green-color);
    }
    .status-1 {
      color: var(--status-red-color)
    }
    .status-2 {
      color: var(--status-yellow-color);
    }
  </style>

  <template>
    <paper-card>
      <paper-material elevation="1">
        <iron-icon class="status-[[status]]" icon="[[icon]]"></iron-icon>
        <div></div>
      </paper-material>
      <paper-material elevation="1">
        <iron-icon class="status-[[status]]" icon="[[icon]]"></iron-icon>
        <div></div>
      </paper-material>
      <paper-material elevation="1">
        <iron-icon class="role-[[status]]" icon="[[icon]]"></iron-icon>
        <div></div>
      </paper-material>
      <paper-material elevation="1">
        <iron-icon class="role-[[status]]" icon="[[icon]]"></iron-icon>
        <div></div>
      </paper-material>
    </paper-card>
  </template>

  <script>
  (function() {
// icon: "icons:report-problem"
// icon: "icons:check-circle"
    "use strict";
    var validRoles = ["ApplicationService","BackEnd","FrontEnd","DistributionApi"]

    Polymer({
      is: 'forge-nodes-status-card',
      behaviors: [ForgeBehaviors.HeartbeatsPollingBehavior],
      properties: {
        role: {
          type: String,
          default:"ApplicationService",
          readOnly:true
        },
        icon: {
          type: String,
          default:"icons:check-circle"
        },
        status: {
          type: Number,
          default:0
        },
        nodes:{
          type: Array
        }
      },
      ready: function() {
        var self = this;
        console.log(self);
        Forge.Api.HeartBeats().then(function(result) {
          var current = result.find(function(r) { return r.Key === self.role; });
          if (current) {
            self._setStatus(current.Status);
          }
        });
      },
      // _enumRole: function(newValue, oldValue) {
      //
      //   var newRole = validRoles[newValue];
      //
      //   if (!newRole) {
      //     this.role = oldValue;
      //     newRole =  validRoles[oldValue];
      //   }
      //
      //   this._setIcon(newRole.icon);
      //
      // }
    });

  })();
  </script>

</dom-module>
