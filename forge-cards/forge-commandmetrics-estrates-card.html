<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/polymer/polymer.html">

<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/paper-card/paper-card.html">
<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/paper-progress/paper-progress.html">
<link rel="import" href="//cdn.rawgit.com/download/polymer-cdn/1.6.1/lib/paper-styles/typography.html">

<link rel="import" href="../forge-shared/forge-shared.html">
<link rel="import" href="../forge-behaviors/forge-polling-behavior.html">
<link rel="import" href="../forge-behaviors/forge-localize-behavior.html">

<link rel="import" href="../moment-element/moment-element.html">

<dom-module id="forge-commandmetrics-estrates-card">

<style>
:host {
  display: block;
}

paper-card {
  display: block;
}

.loading-bar {
  --paper-progress-active-color: var(--paper-light-blue-500);
  width: 100%;
  position: absolute;
}

.card-disclaimer {

}

.card-panels-container {
  margin-top: 8px;
  display: flex;
  flex-direction: row;
}

.card-panel {
  box-sizing: border-box;
  width: 50%;
  padding: 0 4px 0 0;
}

.card-panel:last-child {
  padding: 0 0 0 4px;
}

.card-panel-title {
  text-align: center;
  font-size: 36px;
}

.card-panel-content {
  text-align: center;
  font-size: 72px;
}

</style>

<template>

  <paper-card heading="[[localize('Estimanted Rates')]]">

    <paper-progress hidden$="[[_hideLoading]]" class="loading-bar" indeterminate></paper-progress>

    <div class="card-content">

      <div class="card-disclaimer">[[localize('wcm.cardEstimatedRatesDisclaimer')]]</div>

      <div class="card-panels-container">
        <div class="card-panel">
          <div class="card-panel-title">[[localize('queued')]]</div>
          <div class="card-panel-content">[[_data.queued]]</div>
        </div>
        <div class="card-panel">
          <div class="card-panel-title">[[localize('handled')]]</div>
          <div class="card-panel-content">[[_data.handled]]</div>
        </div>
      </div>

    </div>

  </paper-card>

</template>

<script>
(function() {
  "use strict";

  function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min)) + min;
  }

  function Data(queued, handled) {
    this.queued = queued;
    this.handled = handled;
  }

  Polymer({
    is: 'forge-commandmetrics-estrates-card',
    behaviors: [ForgeWebComponents.Behaviors.PollingBehavior, ForgeWebComponents.Behaviors.ForgeLocalizeBehavior],
    properties: {
      url: {
        type: String,
        value: "/api/history/items/context/wcm"
      },
      interval: {
        type: Number,
        value: 30000
      },
      _data: {
        type: Object,
        value: new Data()
      }
    },
    _onPollingUpdate: function(result) {
      this._data = new Data(getRandomInt(100, 200), getRandomInt(0, 50));
    },
    _onPollingStart: function() {
    }
  });

})();
</script>

</dom-module>
